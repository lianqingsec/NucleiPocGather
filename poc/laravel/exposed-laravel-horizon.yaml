id: exposed-laravel-horizon
info:
  name: exposed-laravel-horizon
  author: osamahamad
  severity: medium
  description: Detects horizon, the one that get expose to the public.
  tags: laravel,custom
  reference:
    - https://laravel.com/docs/9.x/horizon

requests:
  - method: GET
    path:
      - '{{BaseURL}}/horizon'
      - '{{BaseURL}}:8000/horizon'

    redirects: true
    max-redirects: 2
    matchers:
      - type: word
        words:
          - 'horizon'
          - 'jobs/completed'
          - 'jobs/pending'
          - 'metrics'
          - 'dashboard'
        condition: and
        part: body
