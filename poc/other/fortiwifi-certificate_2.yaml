id: fortiwifi-certificate

info:
  name: Fortinet FortiWifi Certificate - Detect
  author: johnk3r
  severity: info
  metadata:
    verified: true
    max-request: 1
    shodan-query: product:"Fortinet FortiWiFi"
  tags: ssl,tls,fortinet,fortiwifi,discovery
ssl:
  - address: "{{Host}}:{{Port}}"

    matchers-condition: and
    matchers:
      - type: word
        part: subject_dn
        words:
          - "O=Fortinet, L=Sunnyvale, ST=California, C=US, emailAddress=support@fortinet.com"

      - type: word
        part: subject_cn
        words:
          - "FW"

    extractors:
      - type: dsl
        dsl:
          - 'subject_cn'
# digest: 4a0a00473045022035d63080bdcc9bc55a92c67bb71fd2c2142659b90a7216552a00d7f31cd61c55022100cce1ec9073a062d94c497a927fd3882888a332123bfff08fa9e0770ce43d222d:922c64590222798bb761d5b6d8e72950