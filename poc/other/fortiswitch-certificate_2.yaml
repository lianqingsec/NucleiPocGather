id: fortiswitch-certificate

info:
  name: Fortinet FortiSwitch Certificate - Detect
  author: johnk3r
  severity: info
  metadata:
    verified: true
    max-request: 1
    shodan-query: ssl:"ou=fortiswitch"
  tags: ssl,tls,fortinet,fortiswitch,discovery

ssl:
  - address: "{{Host}}:{{Port}}"

    matchers-condition: and
    matchers:
      - type: word
        part: subject_dn
        words:
          - "emailAddress=support@fortinet.com"

      - type: word
        part: subject_dn
        words:
          - "OU=FortiSwitch"

    extractors:
      - type: dsl
        dsl:
          - 'subject_cn'
# digest: 4a0a004730450221008538aa9dd36909ed2e9fa9fd8f7c852b6ded8773f592cdbeb93cf9edf387b4d2022017c50aa15822db4f5e3a2f0f8c6dbafd5c007b089f5159641dd72af45e485025:922c64590222798bb761d5b6d8e72950